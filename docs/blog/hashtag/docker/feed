<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	
	xmlns:georss="http://www.georss.org/georss"
	xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
	>

<channel>
	<title>#Docker &#8211; HippoBlog</title>
	<atom:link href="https://blog.hippohack.me/hashtag/docker/feed" rel="self" type="application/rss+xml" />
	<link>https://blog.hippohack.me</link>
	<description>Web開発に関する備忘録や日々の雑記ブログ</description>
	<lastBuildDate>Mon, 17 Feb 2020 23:16:39 +0000</lastBuildDate>
	<language>ja</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.7.13</generator>

<image>
	<url>https://blog.hippohack.me/_cms/wp-content/uploads/2021/03/image.jpg</url>
	<title>#Docker &#8211; HippoBlog</title>
	<link>https://blog.hippohack.me</link>
	<width>32</width>
	<height>32</height>
</image> 
<site xmlns="com-wordpress:feed-additions:1">190967550</site>	<item>
		<title>Let&#8217;s Encryptの更新作業ログ（私の場合）</title>
		<link>https://blog.hippohack.me/web/155</link>
		
		<dc:creator><![CDATA[@hippohack]]></dc:creator>
		<pubDate>Tue, 18 Feb 2020 21:10:17 +0000</pubDate>
				<guid isPermaLink="false">https://blog.hippohack.me/?post_type=web&#038;p=155</guid>

					<description><![CDATA[Dockerイメージを使ってのLet&#8217;s Encryptの更新が必要になったので作業した際のログ。 あくまで私の環境、私の場合のお話です。もっといいやり方があるかもしれません。 📧メールで案内が来る しっかり [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Dockerイメージを使ってのLet&#8217;s Encryptの更新が必要になったので作業した際のログ。</p>
<p>あくまで私の環境、私の場合のお話です。もっといいやり方があるかもしれません。</p>
<h2>📧メールで案内が来る</h2>
<p>しっかりメールで通知してくれるんだから、すばらしい。</p>
<p>それでもみなさんまぁまぁ更新忘れてアクセスできなーいなんてことになるのが人間味があって面白いです。</p>
<blockquote>
<p>Your certificate (or certificates) for the names listed below will expire in 20 days (on 21 Feb 20 01:40 +0000). Please make sure to renew your certificate before then, or visitors to your website will encounter errors.<br />
  We recommend renewing certificates automatically when they have a third of their<br />
  total lifetime left. For Let&#8217;s Encrypt&#8217;s current 90-day certificates, that means<br />
  renewing 30 days before expiration. See<br />
  https://letsencrypt.org/docs/integration-guide/ for details.</p>
</blockquote>
<h2>⚙️更新作業</h2>
<p>もろもろ、設定ファイルの確認やらやってますが、この記事では端折ってます。</p>
<p>ファイル名やドメイン名は適宜置き換えで。</p>
<pre><code>$ docker run --rm -p 443:443 -p 80:80 -v "hoge_certs:/etc/letsencrypt" -v "hoge_certs-data:/var/lib/letsencrypt" certbot/certbot renew
docker: Error response from daemon: driver failed programming external connectivity on endpoint condescending_pike (dfsc17286fbc3256121485d6966687c2109a733e926): Bind for 0.0.0.0:443 failed: port is already allocated.
ERRO[0000] error waiting for container: context canceled
</code></pre>
<p>エラー。そらポート使ってますよね、アプリ動いてますもん。</p>
<p>なんか悔しいが、docker-compose stopしてから再度実行しました。いちいち落とさんでいい方法がありそうですが。</p>
<pre><code>$ docker run --rm -p 443:443 -p 80:80 -v "hoge_certs:/etc/letsencrypt" -v "hoge_certs-data:/var/lib/letsencrypt" certbot/certbot renew
Saving debug log to /var/log/letsencrypt/letsencrypt.log
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Processing /etc/letsencrypt/renewal/hoge.conf
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Cert is due for renewal, auto-renewing...
Non-interactive renewal: random delay of 455.5318872859476 seconds
Plugins selected: Authenticator standalone, Installer None
Renewing an existing certificate
Performing the following challenges:
http-01 challenge for hoge.fuga.com
Waiting for verification...
Cleaning up challenges
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
new certificate deployed without reload, fullchain is
/etc/letsencrypt/live/hoge.fuga.com/fullchain.pem
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
Congratulations, all renewals succeeded. The following certs have been renewed:
  /etc/letsencrypt/live/hoge.fuga.com/fullchain.pem (success)
- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -
</code></pre>
<p>まぁまぁまたされるなー。けどいけたっぽい。</p>
<h2>💡ブラウザで確認</h2>
<p><img src="https://blog.hippohack.me/_cms/wp-content/uploads/2020/02/B4B406BE-AB2D-4AAD-93B7-EDA7EFA993EA.png" alt="Chromeで確認" /></p>
<p>更新されている。2月に切れるのが5月になりました。</p>
<p>今後の課題としては自動更新。あとコンテナを止めずに更新する方法を模索していきたいです。</p>
<h2>🔍 参考サイト</h2>
<ul>
<li><a href="https://qiita.com/kawaz/items/308240f2dfb2e08c1729#%E6%89%8B%E9%A0%86">環境を汚さずにDocker+certbotで手っ取り早くサーバ証明書を取得するメモ &#8211; Qiita</a></li>
<li><a href="https://certbot.eff.org/docs/using.html?highlight=renew#renewing-certificates">User Guide — Certbot 1.1.0.dev0 documentation</a></li>
</ul>
]]></content:encoded>
					
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">155</post-id>	</item>
		<item>
		<title>MailCatcherが動かない &#8211; #php #docker</title>
		<link>https://blog.hippohack.me/web/59</link>
		
		<dc:creator><![CDATA[@hippohack]]></dc:creator>
		<pubDate>Sun, 02 Sep 2018 14:27:52 +0000</pubDate>
				<guid isPermaLink="false">http://blog.hippohack.test/?post_type=web&#038;p=59</guid>

					<description><![CDATA[Docker環境でのMailCatcherがうまく動作しなかったときの対応例。 あくまで自分の設定不備だったり、勘違いが原因でしたので役に立つ情報ではないかもだけど雑なアウトプットとして投稿させていただきます。 結論 r [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Docker環境でのMailCatcherがうまく動作しなかったときの対応例。</p>
<p>あくまで自分の設定不備だったり、勘違いが原因でしたので役に立つ情報ではないかもだけど雑なアウトプットとして投稿させていただきます。</p>
<h2>結論</h2>
<ul>
<li>
<div>rubyとかgemとかインストールしてなかった。</div>
<ul>
<li>オーソドックスなLAMP環境に追加して使った。</li>
</ul>
</li>
<li>
<div>全然設定間違えてた。</div>
</li>
</ul>
<h2>設定例</h2>
<p><em class="file-name">[Dockerfile]</em></p>
<pre><code>    ︙
RUN apt-get install -y ruby ruby-dev rubygems
RUN apt-get install -y libsqlite3-dev
RUN gem install mailcatcher
    ︙</code></pre>
<p><em class="file-name">[docker-compose.yml]</em></p>
<pre><code>version: '3'
services:
    ︙
    hoge_mailcatcher:
        image: schickling/mailcatcher
        container_name: hoge_mailcatcher
        ports:
            - "1080:1080"
            - "1025:1025"</code></pre>
<p><em class="file-name">[php.ini]</em></p>
<pre><code>[mail function]
SMTP = hoge_mailcatcher
smtp_port = 1025
sendmail_path = /usr/bin/env /usr/local/bin/catchmail --smtp-ip hoge_mailcatcher --smtp-port 1025</code></pre>
<h2>参考にさせていただいたサイト</h2>
<ul>
<li><a href="https://qiita.com/reflet/items/6e7c8d7850ff9cdb5d92" target="_blank" rel="noopener noreferrer">ローカルの開発環境にSMTPを整備する &#8211; Qiita</a></li>
<li><a href="https://qiita.com/tkyk0317/items/4de2f81466d1f1b0398c" target="_blank" rel="noopener noreferrer">docker内のPHP(yii)からmailcatcherを使用する &#8211; Qiita</a></li>
</ul>
]]></content:encoded>
					
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">59</post-id>	</item>
	</channel>
</rss>
