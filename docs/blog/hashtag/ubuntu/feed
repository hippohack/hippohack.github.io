<?xml version="1.0" encoding="UTF-8"?><rss version="2.0"
	xmlns:content="http://purl.org/rss/1.0/modules/content/"
	xmlns:wfw="http://wellformedweb.org/CommentAPI/"
	xmlns:dc="http://purl.org/dc/elements/1.1/"
	xmlns:atom="http://www.w3.org/2005/Atom"
	xmlns:sy="http://purl.org/rss/1.0/modules/syndication/"
	xmlns:slash="http://purl.org/rss/1.0/modules/slash/"
	
	xmlns:georss="http://www.georss.org/georss"
	xmlns:geo="http://www.w3.org/2003/01/geo/wgs84_pos#"
	>

<channel>
	<title>#Ubuntu &#8211; HippoBlog</title>
	<atom:link href="https://blog.hippohack.me/hashtag/ubuntu/feed" rel="self" type="application/rss+xml" />
	<link>https://blog.hippohack.me</link>
	<description>Web開発に関する備忘録や日々の雑記ブログ</description>
	<lastBuildDate>Thu, 22 Aug 2019 05:30:18 +0000</lastBuildDate>
	<language>ja</language>
	<sy:updatePeriod>
	hourly	</sy:updatePeriod>
	<sy:updateFrequency>
	1	</sy:updateFrequency>
	<generator>https://wordpress.org/?v=5.7.13</generator>

<image>
	<url>https://blog.hippohack.me/_cms/wp-content/uploads/2021/03/image.jpg</url>
	<title>#Ubuntu &#8211; HippoBlog</title>
	<link>https://blog.hippohack.me</link>
	<width>32</width>
	<height>32</height>
</image> 
<site xmlns="com-wordpress:feed-additions:1">190967550</site>	<item>
		<title>[ubuntu] ハードディスクを追加・マウントする</title>
		<link>https://blog.hippohack.me/web/133</link>
		
		<dc:creator><![CDATA[@hippohack]]></dc:creator>
		<pubDate>Thu, 22 Aug 2019 04:53:27 +0000</pubDate>
				<guid isPermaLink="false">https://blog.hippohack.me/?post_type=web&#038;p=133</guid>

					<description><![CDATA[Ubuntu Server、80GB?のサブのHDDがすでにマウントされてるもんやと思ってたがされてなかったので設定する。 ubuntu serverやと自分のマウントしないといけないのかな？ とりま、ディクス容量確認。 [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Ubuntu Server、80GB?のサブのHDDがすでにマウントされてるもんやと思ってたがされてなかったので設定する。</p>
<p>ubuntu serverやと自分のマウントしないといけないのかな？</p>
<p>とりま、ディクス容量確認。</p>
<pre><code>$ df -h
Filesystem      Size  Used Avail Use% Mounted on
udev            1.9G     0  1.9G   0% /dev
tmpfs           382M   12M  371M   3% /run
/dev/sda2       229G  166G   52G  77% /
tmpfs           1.9G     0  1.9G   0% /dev/shm
tmpfs           5.0M     0  5.0M   0% /run/lock
tmpfs           1.9G     0  1.9G   0% /sys/fs/cgroup
/dev/loop0       89M   89M     0 100% /snap/core/7396
/dev/loop2       89M   89M     0 100% /snap/core/7270
/dev/loop3       98M   98M     0 100% /snap/docker/321
/dev/loop1       98M   98M     0 100% /snap/docker/384
tmpfs           382M     0  382M   0% /run/user/1000
</code></pre>
<p>もしすでにマウントされていれば、<code>/dev/sdb</code> が存在するはず。</p>
<ul>
<li>SCSIハードディスクを使用しているのでsda（プライマリのマスタ） or sdb（プライマリのスレーブ）となる。</li>
<li>IDEハードディスクを使用しているとhdaやhdbになる。</li>
<li></li>
</ul>
<p>状態を確認していたら、</p>
<pre><code>$ sudo fdisk -l /dev/sdb
Disk /dev/sdb: 73.1 GiB, 78518522880 bytes, 153356490 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos

Device    Boot Start       End   Sectors  Size Id Type
/dev/sdb1        2048 153356489 153354442 73.1G 83 Linux
</code></pre>
<p>あった。</p>
<p>（あとからきづいたが、この時点でパーティション切れてるぽいのでマウントだけしてやれば使えたかも。）</p>
<h2>ハードディスクにパーティションを作成する</h2>
<p><code>m</code> でヘルプ確認して実行すべし。</p>
<pre><code>$ sudo fdisk /dev/sdb

Welcome to fdisk (util-linux 2.31.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.

Command (m for help): n
Partition type
   p   primary (0 primary, 0 extended, 4 free)
   e   extended (container for logical partitions)
Select (default p): e
Partition number (1-4, default 1): p
Value out of range.
Partition number (1-4, default 1): 1-4
Value out of range.
Partition number (1-4, default 1): 1
First sector (2048-153356489, default 2048): 
Last sector, +sectors or +size{K,M,G,T,P} (2048-153356489, default 153356489): 

Created a new partition 1 of type 'Extended' and of size 73.1 GiB.
Partition #1 contains a vfat signature.

Do you want to remove the signature? [Y]es/[N]o: Y

The signature will be removed by a write command.

Command (m for help): p
Disk /dev/sdb: 73.1 GiB, 78518522880 bytes, 153356490 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos
Disk identifier: 0x3b643540

Device    Boot Start       End   Sectors  Size Id Type
/dev/sdb1        2048 153356489 153354442 73.1G  5 Extended

Filesystem/RAID signature on partition 1 will be wiped.

Command (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table.
Syncing disks.
</code></pre>
<p>確認、</p>
<pre><code>$ sudo fdisk -l /dev/sdb
Disk /dev/sdb: 73.1 GiB, 78518522880 bytes, 153356490 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos

Device    Boot Start       End   Sectors  Size Id Type
/dev/sdb1        2048 153356489 153354442 73.1G  5 Extended
</code></pre>
<p>できた？？</p>
<h2>ハードディスクのパーティションをフォーマットする</h2>
<pre><code>$ sudo mke2fs /dev/sdb1
mke2fs 1.44.1 (24-Mar-2018)
Found a dos partition table in /dev/sdb1
Proceed anyway? (y,N) y
mke2fs: inode_size (128) * inodes_count (0) too big for a
     filesystem with 0 blocks, specify higher inode_ratio (-i)
     or lower inode count (-N).
</code></pre>
<p>???。ちょっとここ理解できてない。</p>
<h2>ハードディスクをマウントする</h2>
<p>最初にマウント先を用意</p>
<pre><code>$ sudo mkdir sub
</code></pre>
<p>マウントする → エラー</p>
<pre><code>$ sudo mount /dev/sdb1 /sub
mount: /sub: wrong fs type, bad option, bad superblock on /dev/sdb1, missing codepage or helper program, or other error.
</code></pre>
<p>パーティションの作成し直し</p>
<pre><code>$ sudo fdisk /dev/sdb

Welcome to fdisk (util-linux 2.31.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.

Command (m for help): d
Selected partition 1
Partition 1 has been deleted.

Command (m for help): p
Disk /dev/sdb: 73.1 GiB, 78518522880 bytes, 153356490 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos

Command (m for help): n
Partition type
   p   primary (0 primary, 0 extended, 4 free)
   e   extended (container for logical partitions)
Select (default p): p
Partition number (1-4, default 1): 
First sector (2048-153356489, default 2048): 
Last sector, +sectors or +size{K,M,G,T,P} (2048-153356489, default 153356489): 

Created a new partition 1 of type 'Linux' and of size 73.1 GiB.

Command (m for help): w
The partition table has been altered.
Calling ioctl() to re-read partition table.
Syncing disks.


$ sudo fdisk -l /dev/sdb
Disk /dev/sdb: 73.1 GiB, 78518522880 bytes, 153356490 sectors
Units: sectors of 1 * 512 = 512 bytes
Sector size (logical/physical): 512 bytes / 512 bytes
I/O size (minimum/optimal): 512 bytes / 512 bytes
Disklabel type: dos

Device    Boot Start       End   Sectors  Size Id Type
/dev/sdb1        2048 153356489 153354442 73.1G 83 Linux
</code></pre>
<p>拡張ではなくprimaryにした。タイプが Linux になった。</p>
<pre><code>$ sudo mke2fs /dev/sdb1

$ sudo mount /dev/sdb1 /sub
</code></pre>
<p>確認。</p>
<pre><code>$ mount
/dev/sda2 on / type ext4 (rw,relatime,data=ordered)
/dev/sdb1 on /sub type ext2 (rw,relatime,block_validity,barrier,user_xattr,acl)

$ df -h
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda2       229G  166G   52G  77% /
/dev/sdb1        72G   52M   69G   1% /sub
</code></pre>
<h2>自動マウントさせる</h2>
<p>システム起動時に自動的にマウントされるよう設定する。</p>
<ul>
<li>/etc/fstabファイルを編集・追記 </li>
<li>
<p>各パラメータ詳細は参考サイトを確認</p>
<p>$ sudo vim /etc/fstab</p>
</li>
</ul>
<p><em class="file-name">[/etc/fstab]</em></p>
<pre><code>︙
︙
/dev/sdb1 /sub ext2 defaults 0 0
</code></pre>
<p>再起動して確認</p>
<pre><code>$ shutdown -r now

$ df -h
Filesystem      Size  Used Avail Use% Mounted on
/dev/sda2       229G  166G   52G  77% /
/dev/sdb1        72G   52M   69G   1% /sub
</code></pre>
<h2>マウントするディレクトリを変更する</h2>
<p>気に入らなかったので変更。一旦アンマウント。</p>
<pre><code>$ umount /sub

$ sudo mount /dev/sdb1 /home/share/_sdb
</code></pre>
<p><code>/etc/fstab</code> も修正。</p>
<h2>参考サイト</h2>
<ul>
<li><a href="http://ext.omo3.com/linux/hdd-tsuika/index.html">Linuxにハードディスクを増設する │ 渋谷生活</a></li>
<li></li>
</ul>
]]></content:encoded>
					
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">133</post-id>	</item>
		<item>
		<title>[ubuntu] ファイルサーバー/samba入れる</title>
		<link>https://blog.hippohack.me/web/135</link>
		
		<dc:creator><![CDATA[@hippohack]]></dc:creator>
		<pubDate>Wed, 21 Aug 2019 05:01:59 +0000</pubDate>
				<guid isPermaLink="false">https://blog.hippohack.me/?post_type=web&#038;p=135</guid>

					<description><![CDATA[Macのストレージがパンパン、外付けHDDの容量もあけたかったのでNAS的目的でUbuntu ServerでSambaを使ってみることにした。 とりまゲストで使えるようにする インストール $ sudo apt-get  [&#8230;]]]></description>
										<content:encoded><![CDATA[<p>Macのストレージがパンパン、外付けHDDの容量もあけたかったのでNAS的目的でUbuntu ServerでSambaを使ってみることにした。</p>
<h2>とりまゲストで使えるようにする</h2>
<p>インストール</p>
<pre><code>$ sudo apt-get -y install samba
</code></pre>
<p>シェアフォルダの作成・権限変更</p>
<pre><code>$ sudo mkdir /home/share
$ sudo chmod 777 /home/share
</code></pre>
<p>設定ファイル編集</p>
<pre><code>$ sudo vim /etc/samba/smb.conf
</code></pre>
<p><em class="file-name">[/etc/samba/smb.conf]</em></p>
<pre><code>[global]
   unix charset = UTF-8
   dos charset = CP932 
   interfaces = eth0 127.0.0.0/8 192.168.0.0/24
   bind interfaces only = yes
   map to guest = bad user

[share]
   path = /home/share
   writable = yes
   guest ok = yes
   guest only = yes
   create mode = 0777
   directory mode = 0777
   share modes = yes
</code></pre>
<ul>
<li>編集・追加したものだけメモ</li>
</ul>
<p>samba再起動・システム起動時のスタートを許可</p>
<pre><code>$ sudo systemctl restart smbd
$ sudo systemctl enable smbd
</code></pre>
<p>Macのファインダーから接続確認。入れることを確認。</p>
<h2>アカウント作る</h2>
<p>ubuntuのアカウントを登録するので今回アカウントは新規作成せず。グループも。</p>
<p>sambaユーザ登録</p>
<pre><code>$ sudo pdbedit -a USERNAME
→ パスワード聞かれる
</code></pre>
<p>設定ファイル編集</p>
<p><em class="file-name">[/etc/samba/smb.conf]</em></p>
<pre><code>[share]
   path = /home/share
   writable = yes
   browseable = yes
   ;guest ok = yes
   ;guest only = yes
   create mode = 0777
   directory mode = 0777
   share modes = yes
   valid users = @GROUPNAME
</code></pre>
<p>guestで入れなくなって、登録したユーザで入れることを確認。</p>
<p>別途、ゲストで作成していたファイルはユーザとグループをすべて変更する処理した。</p>
<ul>
<li>HDDで、SSDではないので遅いが使えることは使える。</li>
<li>iTunesライブラリなんかも移動して使えたのでGood。</li>
</ul>
<h2>参考サイト</h2>
<ul>
<li><a href="https://qiita.com/msrks/items/1385cf13258dd1a0da08">Ubuntuでファイルサーバーをたてる（Samba） &#8211; Qiita</a></li>
<li><a href="http://itemy.net/?p=664">Ubuntuでsambaを使ってファイル共有する</a></li>
<li><a href="https://help.ubuntu.com/lts/serverguide/samba-fileserver.html">File Server</a></li>
<li><a href="https://help.ubuntu.com/community/How%20to%20Create%20a%20Network%20Share%20Via%20Samba%20Via%20CLI%20(Command-line%20interface/Linux%20Terminal)%20-%20Uncomplicated,%20Simple%20and%20Brief%20Way!">How to Create a Network Share Via Samba Via CLI (Command-line interface/Linux Terminal) &#8211; Uncomplicated, Simple and Brief Way! &#8211; Community Help Wiki</a></li>
<li><a href="http://www.miloweb.net/samba.html">Samba の導入 &#8211; Linux で自宅サーバ [ Home Server Technical. ]</a></li>
<li><a href="https://www.virment.com/config-sambaserver/">sambaサーバによるファイル共有環境の構築手順</a></li>
</ul>
]]></content:encoded>
					
		
		
		<post-id xmlns="com-wordpress:feed-additions:1">135</post-id>	</item>
	</channel>
</rss>
